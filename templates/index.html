<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speech Transcription and Translation System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f9;
        }
        header {
            background-color: #004d99;
            color: white;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 2rem auto;
        }
        .feature {
            background: white;
            margin-bottom: 1.5rem;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.3s;
            display: flex;
            align-items: center;
        }
        .feature i {
            font-size: 2rem;
            color: #004d99;
            margin-right: 1rem;
        }
        .feature:hover {
            transform: scale(1.02);
        }
        .feature h2 {
            color: #333;
            margin-top: 0;
        }
        .feature p {
            color: #555;
            line-height: 1.6;
        }
        footer {
            background-color: #004d99;
            color: white;
            text-align: center;
            padding: 1rem;
            position: fixed;
            bottom: 0;
            width: 100%;
            box-shadow: 0 -2px 4px rgba(0,0,0,0.1);
        }
        footer p {
            margin: 0;
        }
        form {
            margin-bottom: 1.5rem;
        }
        input[type="file"], textarea {
            margin-bottom: 1rem;
        }
        textarea {
            width: 100%;
            height: 100px;
        }
        button {
            padding: 0.5rem 1rem;
            color: white;
            background-color: #004d99;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #003366;
        }
        @media (max-width: 768px) {
            .container {
                width: 95%;
            }
            header, footer {
                padding: 1rem;
            }
        }
        .hidden {
            display: none;
        }
        .transcription-status {
            margin-top: 1rem;
            font-style: italic;
        }
    </style>
</head>
<body>
    <header>
        <h1>Speech Transcription and Translation System</h1>
    </header>
    <div class="container">

        <!-- Speech-to-Text Converter -->
        <div class="feature" id="speech-to-text">
            <i class="fas fa-microphone"></i>
            <div>
                <h2>Speech-to-Text Converter</h2>
                <form action="/speech-to-text" method="post" enctype="multipart/form-data">
                    <input type="file" name="audio" accept="audio/*" required>
                    <button type="submit">Convert Speech to Text</button>
                </form>
                <div id="speech-to-text-output">
                    {% if speech_to_text_output %}
                        <h3>Transcription:</h3>
                        <textarea readonly rows="10" cols="50">{{ speech_to_text_output }}</textarea>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Text-to-Speech -->
        <div class="feature" id="text-to-speech">
            <i class="fas fa-volume-up"></i>
            <div>
                <h2>Text-to-Speech</h2>
                <form action="/text-to-speech" method="post">
                    <textarea name="text" placeholder="Enter text here..." required></textarea>
                    <button type="submit">Convert Text to Speech</button>
                </form>
            </div>
        </div>

        <!-- Real-Time Transcription -->
        <div class="feature" id="real-time-transcription">
  <i class="fas fa-clock"></i>
  <div>
    <h2>🎤 Real-Time Transcription</h2>
    <p id="state">idle</p>

    <textarea name="text" id="transcript" contenteditable="false"
      aria-label="Live transcript" placeholder="Live transcription will appear here..."
      required></textarea>

    <label for="lang">Language:</label>
    <select id="lang">
      <option value="en-US">English (US)</option>
      <option value="en-GB">English (UK)</option>
      <option value="hi-IN">Hindi (India)</option>
      <option value="es-ES">Spanish</option>
    </select>

    <div style="margin-top:10px;">
      <button id="startBtn">Start</button>
      <button id="stopBtn" disabled>Stop</button>
      <button id="clearBtn">Clear</button>
    </div>
  </div>
</div>

        <!-- Speaker Identification -->
        <div class="feature" id="speaker-identification">
            <i class="fas fa-users"></i>
            <div>
                <h2>Speaker Identification</h2>
                <form action="/speaker-identification" method="post" enctype="multipart/form-data">
                    <input type="file" name="audio" accept="audio/*" required>
                    <button type="submit">Identify Speakers</button>
                </form>
                <div id="speaker-identification-output">
                    {% if speaker_identification_output %}
                        <textarea readonly rows="10" cols="50">{{ speaker_identification_output }}</textarea>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Audio & Video Integration -->
        <div class="feature" id="audio-video-integration">
            <i class="fas fa-film"></i>
            <div>
                <h2>Audio & Video Integration</h2>
                <form action="/audio-video-integration" method="post" enctype="multipart/form-data">
                    <input type="file" name="media" accept="video/*" required>
                    <button type="submit">Convert Video to Audio</button>
                </form>
            </div>
        </div>

        <!-- Search and Indexing -->
        <div class="feature" id="search-indexing">
            <i class="fas fa-search"></i>
            <div>
                <h2>Search and Indexing</h2>
                <form action="/search-indexing" method="post" enctype="multipart/form-data">
                    <textarea name="search-query" placeholder="Enter search query..." required></textarea>
                    <label for="file-upload">Upload a .txt file:</label>
                    <input type="file" name="file" id="file-upload" accept=".txt" required>
                    <button type="submit">Search Transcripts</button>
                </form>
                <div id="search-indexing-output">
                    {% if search_result %}
                        <p>{{ search_result }}</p>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Editing Tools -->
        <div class="feature" id="editing-tools">
            <i class="fas fa-edit"></i>
            <div>
                <h2>Editing Tools</h2>
                <form action="/editing-tools" method="post" enctype="multipart/form-data">
                    <input type="file" name="file" accept=".txt" required>
                    <button type="submit">Upload File</button>
                </form>
                {% if file_content %}
                    <form action="/save-edited-text" method="post">
                        <textarea name="edited_text" rows="10" cols="50">{{ file_content }}</textarea>
                        <input type="hidden" name="file_name" value="{{ file_name }}">
                        <button type="submit">Save Changes</button>
                    </form>
                {% endif %}
                {% if success_message %}
                    <p style="color: green;">{{ success_message }}</p>
                {% endif %}
            </div>
        </div>

        <!-- Export Options -->
        <div class="feature" id="export-options">
            <i class="fas fa-file-export"></i>
            <div>
                <h2>Export Options</h2>
                <form action="/export-options" method="post">
                    <textarea name="text" placeholder="Enter text here..." required></textarea>
                    <select name="format">
                        <option value="pdf">PDF</option>
                        <option value="docx">DOCX</option>
                        <option value="txt">TXT</option>
                    </select>
                    <button type="submit">Export Transcription</button>
                </form>
            </div>
        </div>

        <!-- Privacy and Security -->
        <div class="feature" id="privacy-security">
            <i class="fas fa-lock"></i>
            <div>
                <h2>Privacy and Security</h2>
                <form action="/privacy-security" method="post">
                    <textarea name="data" placeholder="Enter data to encrypt..." required></textarea>
                    <button type="submit">Encrypt Data</button>
                </form>
                {% if encrypted_data %}
                    <h3>Encrypted Data</h3>
                    <textarea readonly>{{ encrypted_data }}</textarea>
                    <h3>Encryption Key</h3>
                    <textarea readonly>{{ key }}</textarea>
                {% endif %}
            </div>
        </div>

        <!-- Decrypt Data -->
        <div class="feature" id="decrypt-data">
            <i class="fas fa-unlock"></i>
            <div>
                <h2>Decrypt Data</h2>
                <form action="/decrypt" method="post">
                    <textarea name="cipher_text" placeholder="Enter encrypted data..." required></textarea>
                    <input type="text" name="key" placeholder="Enter encryption key..." required>
                    <button type="submit">Decrypt Data</button>
                </form>
                {% if decrypted_data %}
                    <h3>Decrypted Data</h3>
                    <textarea readonly>{{ decrypted_data }}</textarea>
                {% endif %}
            </div>
        </div>

        <!-- Google Drive Integration -->
        <div class="feature" id="google-drive-integration">
            <i class="fas fa-cloud-upload-alt"></i>
            <div>
                <h2>Google Drive Integration</h2>
                <form action="/upload-to-drive" method="post" enctype="multipart/form-data">
                    <input type="file" name="file" required>
                    <button type="submit">Upload to Google Drive</button>
                </form>
            </div>
        </div>
    </div>

    <footer>
        <p>&copy; <b>Dharmendra</b> Speech Transcription and Translation System</p>
    </footer>

    <script>
(() => {
  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  const startBtn = document.getElementById('startBtn');
  const stopBtn  = document.getElementById('stopBtn');
  const clearBtn = document.getElementById('clearBtn');
  const transcriptEl = document.getElementById('transcript');
  const stateEl = document.getElementById('state');
  const langSelect = document.getElementById('lang');

  if (!SpeechRecognition) {
    stateEl.textContent = '❌ Web Speech API not supported — use Chrome/Edge.';
    startBtn.disabled = true;
    stopBtn.disabled = true;
    return;
  }

  let recognition = null;
  let manualStop = false;
  let finalTranscript = transcriptEl.value || ''; // Keep across sessions

  function createRecognition() {
    const r = new SpeechRecognition();
    r.lang = langSelect.value || 'en-US';
    r.interimResults = true;
    r.continuous = true;
    r.maxAlternatives = 1;

    r.onstart = () => {
      stateEl.textContent = '🎙️ Listening...';
      startBtn.disabled = true;
      stopBtn.disabled = false;
    };

    r.onerror = (e) => {
      console.error('Recognition error', e);
      if (e.error === 'not-allowed' || e.error === 'permission-denied')
        stateEl.textContent = '🚫 Microphone permission denied';
      else if (e.error === 'network')
        stateEl.textContent = '🌐 Network error';
      else
        stateEl.textContent = '⚠️ Error: ' + e.error;
    };

    r.onresult = (event) => {
      let interim = '';
      for (let i = event.resultIndex; i < event.results.length; ++i) {
        const res = event.results[i];
        if (res.isFinal) {
          finalTranscript += res[0].transcript + ' ';
        } else {
          interim += res[0].transcript;
        }
      }
      transcriptEl.value = (finalTranscript + interim).trim();
      transcriptEl.scrollTop = transcriptEl.scrollHeight;
    };

    r.onend = () => {
      if (manualStop) {
        stateEl.textContent = '⏹️ Stopped';
        startBtn.disabled = false;
        stopBtn.disabled = true;
      } else {
        stateEl.textContent = '🔄 Restarting...';
        setTimeout(() => {
          try {
            recognition = createRecognition();
            recognition.start();
          } catch (err) {
            stateEl.textContent = '❌ Failed to restart';
            startBtn.disabled = false;
            stopBtn.disabled = true;
          }
        }, 300);
      }
    };

    return r;
  }

  startBtn.addEventListener('click', () => {
    manualStop = false;
    recognition = createRecognition();
    recognition.start();
    stateEl.textContent = '⏳ Starting...';
  });

  stopBtn.addEventListener('click', () => {
    if (!recognition) return;
    manualStop = true;
    recognition.stop();
  });

  clearBtn.addEventListener('click', () => {
    finalTranscript = '';
    transcriptEl.value = '';
    stateEl.textContent = '🗑️ Cleared';
  });

  langSelect.addEventListener('change', () => {
    if (recognition && stateEl.textContent.includes('Listening')) {
      manualStop = false;
      recognition.stop();
      setTimeout(() => {
        recognition = createRecognition();
        recognition.start();
      }, 300);
    }
  });
})();
</script>


</body>
</html>
